<div class="recitations-list">
  <div class="recitations-list__toolbar">
    <div class="recitations-list__search">
      <nz-input-group [nzPrefix]="searchIconTpl">
        <input
          nz-input
          type="text"
          [placeholder]="'RECITATIONS.LIST.SEARCH_PLACEHOLDER' | translate"
          [ngModel]="searchQuery()"
          (ngModelChange)="onSearchInput($event)"
        />
      </nz-input-group>
      <ng-template #searchIconTpl>
        <i class="bx bx-search recitations-list__search-icon"></i>
      </ng-template>
    </div>

    <div class="recitations-list__filters">
      <nz-select
        class="recitations-list__filter-select"
        [nzPlaceHolder]="'RECITATIONS.LIST.FILTER_RIWAYAH' | translate"
        [ngModel]="riwayahFilter()"
        (ngModelChange)="onRiwayahChange($event)"
        nzAllowClear
      >
        @for (option of RIWAYAH_OPTIONS; track option) {
          <nz-option [nzValue]="option" [nzLabel]="option"></nz-option>
        }
      </nz-select>

      <nz-select
        class="recitations-list__filter-select"
        [nzPlaceHolder]="'RECITATIONS.LIST.FILTER_TYPE' | translate"
        [ngModel]="recitationTypeFilter()"
        (ngModelChange)="onRecitationTypeChange($event)"
        nzAllowClear
      >
        @for (option of RECITATION_TYPE_OPTIONS; track option) {
          <nz-option [nzValue]="option" [nzLabel]="option"></nz-option>
        }
      </nz-select>

      @if (hasActiveFilters) {
        <button
          nz-button
          nzType="default"
          nzSize="small"
          class="recitations-list__clear-btn"
          (click)="clearFilters()"
        >
          <i class="bx bx-x"></i>
          {{ 'RECITATIONS.LIST.CLEAR_FILTERS' | translate }}
        </button>
      }
    </div>
  </div>

  <nz-table
    #recitationsTable
    [nzData]="recitations()"
    [nzLoading]="loading()"
    [nzTotal]="total()"
    [nzPageIndex]="pageIndex()"
    [nzPageSize]="pageSize()"
    [nzFrontPagination]="false"
    [nzShowSizeChanger]="true"
    [nzPageSizeOptions]="[5, 10, 20]"
    nzSize="middle"
    [nzNoResult]="emptyTpl"
    (nzPageIndexChange)="onPageChange($event)"
    (nzPageSizeChange)="onPageSizeChange($event)"
  >
    <thead>
      <tr>
        <th>{{ 'RECITATIONS.LIST.COLUMNS.RECITER' | translate }}</th>
        <th>{{ 'RECITATIONS.LIST.COLUMNS.RIWAYAH' | translate }}</th>
        <th>{{ 'RECITATIONS.LIST.COLUMNS.TYPE' | translate }}</th>
        <th>{{ 'RECITATIONS.LIST.COLUMNS.SURAHS' | translate }}</th>
        <th>{{ 'RECITATIONS.LIST.COLUMNS.QUALITY' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      @for (item of recitationsTable.data; track item.id) {
        <tr>
          <td class="recitations-list__reciter-name">
            <span class="recitations-list__name-ar">{{ item.reciter_name_ar }}</span>
            <span class="recitations-list__name-en">{{ item.reciter_name_en }}</span>
          </td>
          <td>
            <nz-tag nzColor="geekblue">{{ item.riwayah }}</nz-tag>
          </td>
          <td>
            <nz-tag nzColor="green">{{ item.recitation_type }}</nz-tag>
          </td>
          <td>{{ item.total_surahs }}</td>
          <td>
            <nz-tag nzColor="orange">{{ item.audio_quality }}</nz-tag>
          </td>
        </tr>
      }
    </tbody>
  </nz-table>
</div>

<ng-template #emptyTpl>
  <div class="recitations-list__empty">
    <i class="bx bx-headphone recitations-list__empty-icon"></i>
    @if (hasActiveFilters) {
      <p>{{ 'RECITATIONS.LIST.NO_FILTER_RESULTS' | translate }}</p>
    } @else {
      <p>{{ 'RECITATIONS.LIST.EMPTY' | translate }}</p>
    }
  </div>
</ng-template>
